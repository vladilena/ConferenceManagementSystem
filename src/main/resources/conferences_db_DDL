CREATE DATABASE IF NOT EXISTS conferences_db;
CREATE TABLE conferences_db.role (role_id int(11) NOT NULL AUTO_INCREMENT,name varchar(20) NOT NULL,PRIMARY KEY (role_id));
CREATE TABLE conferences_db.user (user_id int(11) NOT NULL AUTO_INCREMENT,login varchar(15) NOT NULL,password varchar(100) NOT NULL,email varchar(50) NOT NULL,first_name varchar(45) NOT NULL,first_name_en varchar(45) NOT NULL,last_name varchar(45) NOT NULL,last_name_en varchar(45) NOT NULL,role_id int(11) NOT NULL,PRIMARY KEY (user_id),UNIQUE KEY login (login),KEY role_id_fk (role_id),CONSTRAINT role_id_fk FOREIGN KEY (role_id) REFERENCES role (role_id)ON DELETE NO ACTION ON UPDATE NO ACTION);
CREATE TABLE conferences_db.speaker (user_id int(11) NOT NULL AUTO_INCREMENT,rating decimal(10,2) DEFAULT '0',bonus decimal(10,2) DEFAULT '0',PRIMARY KEY (user_id),CONSTRAINT user_id_fk1 FOREIGN KEY (user_id) REFERENCES user (user_id) ON DELETE CASCADE ON UPDATE CASCADE);
CREATE TABLE conferences_db.conference (conference_id int(11) NOT NULL AUTO_INCREMENT,title varchar(200) NOT NULL,title_en varchar(200) NOT NULL,description varchar(200) NOT NULL,description_en varchar(200) NOT NULL,date_time timestamp NOT NULL,place varchar(200) NOT NULL,place_en varchar(200) NOT NULL,lectures_capacity int(11) NOT NULL,place_capacity int(11) NOT NULL,PRIMARY KEY (conference_id)) ;
CREATE TABLE conferences_db.lecture (lecture_id int(11) NOT NULL AUTO_INCREMENT,start_time timestamp NOT NULL,lecture_title varchar(200) NOT NULL,lecture_title_en varchar(200) NOT NULL,lecture_description varchar(200) NOT NULL,lecture_description_en varchar(200) NOT NULL,approved tinyint(1) NOT NULL DEFAULT '0',speaker_id int(11) DEFAULT NULL,conference_id int(11) DEFAULT NULL,PRIMARY KEY (lecture_id),KEY conference_id_fk (conference_id),KEY speaker_id_fk (speaker_id),CONSTRAINT conference_id_fk FOREIGN KEY (conference_id) REFERENCES conference (conference_id) ON DELETE CASCADE ON UPDATE CASCADE,CONSTRAINT speaker_id_fk FOREIGN KEY (speaker_id) REFERENCES speaker (user_id) ON DELETE SET NULL ON UPDATE SET NULL);
CREATE TABLE conferences_db.user_conference (user_id int(11) NOT NULL,conference_id int(11) NOT NULL,PRIMARY KEY (conference_id,user_id),KEY user_id_fk (user_id),CONSTRAINT conference_id_fk2 FOREIGN KEY (conference_id) REFERENCES conference (conference_id) ON DELETE CASCADE ON UPDATE CASCADE,CONSTRAINT user_id_fk FOREIGN KEY (user_id) REFERENCES user (user_id) ON DELETE CASCADE ON UPDATE CASCADE);
